#llamamos las librerias necesarias.
library(dplyr)
library(ade4)
library(adespatial)
library(vegan)
library(gclus)
library(cluster)
#llamamos las librerias necesarias.
library(dplyr)
library(ade4)
library(adespatial)
library(vegan)
library(gclus)
library(cluster)
library(pvclust)
library(RColorBrewer)
library(labdsv)
library(rioja)
library(indicspecies)
library(mvpart)
library(dendextend)
library(vegclust)
library(colorspace)
library(agricolae)
library(picante)
#Recurso de funciones adicionales
source("drawmap.R")
source("drawmap3.R")
source("hcoplot.R")
source("test.a.R")
source("coldiss.R")
source("bartlett.perm.R")
source("boxplerk.R")
source("boxplert.R")
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- t(as.matrix(datos_bio))
colnames(datos_bio) <- datos_bio[1,]
#Elegimos directorio
setwd(choose.dir())
#llamamos las librerias necesarias.
library(dplyr)
library(ade4)
library(adespatial)
library(vegan)
library(gclus)
library(cluster)
library(pvclust)
library(RColorBrewer)
library(labdsv)
library(rioja)
library(indicspecies)
library(mvpart)
library(MVPARTwrap)
library(indicspecies)
library(mvpart)
library(MVPARTwrap)
library(dendextend)
library(vegclust)
library(colorspace)
library(agricolae)
library(picante)
#Recurso de funciones adicionales
source("drawmap.R")
source("drawmap3.R")
source("hcoplot.R")
source("test.a.R")
source("coldiss.R")
source("bartlett.perm.R")
source("boxplerk.R")
source("boxplert.R")
#Recurso de funciones adicionales
source("drawmap.R")
source("drawmap3.R")
source("hcoplot.R")
source("test.a.R")
source("coldiss.R")
source("bartlett.perm.R")
source("boxplerk.R")
source("boxplert.R")
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
#llamamos las librerias necesarias.
library(readxl)
datos_bio
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- t(as.matrix(datos_bio))
colnames(datos_bio) <- datos_bio[1,]
datos_bio = datos_bio[-1,]
View(datos_bio)
datos_env <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-env data")
dist_comunidad <- vegdist(comunidad, method = "bray")
dist_comunidad <- vegdist(datos_bio, method = "bray")
View(datos_bio)
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- t(as.matrix(datos_bio))
colnames(datos_bio) <- datos_bio[1,]
View(datos_bio)
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
View(datos_bio)
View(datos_bio)
row.names(datos_bio) <- datos_bio[,1]
rownames(datos_bio) <- datos_bio[,1]
View(datos_bio)
rownames(datos_bio) <- datos_bio$...1
View(datos_bio)
datos_bio <- datos_bio[,-1]
View(datos_bio)
t(datos_bio)
datos_bio <- t(datos_bio)
View(datos_bio)
datos_bio <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
rownames(datos_bio) <- datos_bio$...1
View(datos_bio)
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- datos[,-1]
rownames(datos_bio) <- datos_bio$...1
View(datos_bio)
rownames(datos_bio) <- datos$...1
View(datos_bio)
View(datos_bio)
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- datos[,-1]
datos_bio <- t(datos_bio)
rownames(datos_bio) <- datos$...1
View(datos_bio)
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
datos_bio <- datos[,-1]
datos_bio <- t(datos_bio)
colnames(datos_bio) <- datos$...1
View(datos_bio)
datos_env <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-env data")
View(datos_env)
# Preparamos la base de datos ambientales
colnames(datos) = c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO",
"Lítico","Esqueletico","Cambisoles","Fluvisoles","P.del suelo","pH",
"Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")
datos1 <- datos[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos2 <- datos[,c("Lítico","Esqueletico","Cambisoles","Fluvisoles", "Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")]
datos <- cbind(datos1,datos2)
dist_comunidad <- vegdist(datos_bio, method = "bray")
View(dist_comunidad)
dist_comunidad
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
envfit_result <- envfit(nmds, variables_ambientales, permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
envfit_result <- envfit(nmds, variables_ambientales, permutations = 999)
envfit_result <- envfit(nmds, datos_env, permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
envfit_result <- envfit(nmds, datos_env, permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
#Se transpone la base de datos dejando las parcelas como filas
datos_bio <- datos[,-1]
datos_bio <- t(datos_bio)
colnames(datos_bio) <- datos$...1
datos_env <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-env data")
# Preparamos la base de datos ambientales
colnames(datos_env) = c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO",
"Lítico","Esqueletico","Cambisoles","Fluvisoles","P.del suelo","pH",
"Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")
datos_env <- datos[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos_env <- datos[,c("Lítico","Esqueletico","Cambisoles","Fluvisoles", "Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")]
# Preparamos la base de datos ambientales
colnames(datos_env) = c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO",
"Lítico","Esqueletico","Cambisoles","Fluvisoles","P.del suelo","pH",
"Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")
datos_env <- datos[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
#Se transpone la base de datos dejando las parcelas como filas
datos_bio <- datos[,-1]
datos_bio <- t(datos_bio)
colnames(datos_bio) <- datos$...1
datos_env <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-env data")
# Preparamos la base de datos ambientales
colnames(datos_env) = c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO",
"Lítico","Esqueletico","Cambisoles","Fluvisoles","P.del suelo","pH",
"Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")
datos_env <- datos[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos1 <- datos_env[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos2 <- datos_env[,c("Lítico","Esqueletico","Cambisoles","Fluvisoles", "Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")]
datos <- cbind(datos1,datos2)
datos <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-species")
#Se transpone la base de datos dejando las parcelas como filas
datos_bio <- datos[,-1]
datos_bio <- t(datos_bio)
colnames(datos_bio) <- datos$...1
datos_env <- read_xlsx("C:\\Users\\Asus\\Desktop\\Analisis multivariado\\Informe-final-de-multivariada\\Base de datos y contextos\\vltava.xlsx",
sheet = "Vltava-env data")
# Preparamos la base de datos ambientales
colnames(datos_env) = c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO",
"Lítico","Esqueletico","Cambisoles","Fluvisoles","P.del suelo","pH",
"Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")
datos1 <- datos_env[,c("Parcela","Transecto","Elevación","Pendiente","Orientación SE",
"Orientación S-SE", "CCSE","CCS-SE","Superficie PD","Superficie ISO","P.del suelo","pH")]
datos2 <- datos_env[,c("Lítico","Esqueletico","Cambisoles","Fluvisoles", "Cobertura veg.","Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes","Riqueza sp","Grupos")]
datos_env <- cbind(datos1,datos2)
dist_comunidad <- vegdist(datos_bio, method = "bray")
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
ordispider(nmds, datos_env$Grupos, col = "red")
# Plot NMDS con vectores ambientales
plot(nmds, type = "t")
ordispider(nmds, datos_env$Grupos, col = "black")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
# Plot NMDS con vectores ambientales
plot(nmds, type = "n")
points(nmds, display = "sites", datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
# Plot NMDS con vectores ambientales
plot(nmds, type = "n")
points(nmds, display = "sites", col = datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
nmds$stress
# Plot NMDS con vectores ambientales
plot(nmds, type = "n", title == nmds$stress)
points(nmds, display = "sites", col = datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
# Plot NMDS con vectores ambientales
plot(nmds, type = "n")
points(nmds, display = "sites", col = datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
nmds <- metaMDS(dist_comunidad, k = 3, trymax = 100)
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "n")
points(nmds, display = "sites", col = datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
nmds$stress
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
nmds <- metaMDS(dist_comunidad, k = 2, trymax = 100)
envfit_result <- envfit(nmds, datos_env[,c("Luz","Temperatura","Continentalidad","Humedad",
"Reactividad","Nutrientes")], permutations = 999)
# Plot NMDS con vectores ambientales
plot(nmds, type = "n")
points(nmds, display = "sites", col = datos_env$Grupos)
ordispider(nmds, datos_env$Grupos, col = "black")
plot(envfit_result, p.max = 0.05, col = "blue")  # Solo muestra vectores significativos
